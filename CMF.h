// CIE 1931 XYZ等色関数の配列。
// 1nm単位で390nm～830nmまでの等色関数の値をXYZそれぞれに格納した。
//λ=a[nm](aは390以上830以下の整数)の等色関数の値は、CMF_390_830_X[a-390]となる。
//なお、等色関数の値は下記のサイトの値を使用した。
// http://cvrl.ioo.ucl.ac.uk/cmfs.htm
const double CMF_390_830_X[] = {0.003769647, 0.004532416, 0.005446553, 0.006538868, 0.007839699, 0.009382967, 0.011206080, 0.013349650, 0.015856900, 0.018772860, 0.022143020, 0.026012850, 0.030430360, 0.035443250, 0.041096400, 0.047429860, 0.054473940, 0.062236120, 0.070700480, 0.079825130, 0.089538030, 0.099748480, 0.110401900, 0.121456600, 0.132874100, 0.144621400, 0.156646800, 0.168790100, 0.180832800, 0.192521600, 0.203572900, 0.213753100, 0.223134800, 0.231924500, 0.240389200, 0.248852300, 0.257589600, 0.266499100, 0.275353200, 0.283892100, 0.291824600, 0.298920000, 0.305299300, 0.311203100, 0.316904700, 0.322708700, 0.328819400, 0.334924200, 0.340545200, 0.345168800, 0.348255400, 0.349415300, 0.348907500, 0.347174600, 0.344670500, 0.341848300, 0.339024000, 0.335992600, 0.332427600, 0.328015700, 0.322463700, 0.315622500, 0.307820100, 0.299477100, 0.290977600, 0.282664600, 0.274796200, 0.267431200, 0.260584700, 0.254274900, 0.248525400, 0.243303900, 0.238341400, 0.233325300, 0.227961900, 0.221978100, 0.215173500, 0.207561900, 0.199218300, 0.190229000, 0.180690500, 0.170715400, 0.160447100, 0.150024400, 0.139570500, 0.129192000, 0.118985900, 0.109061500, 0.099514240, 0.090418500, 0.081828950, 0.073768170, 0.066194770, 0.059063800, 0.052342420, 0.046008650, 0.040061540, 0.034543730, 0.029490910, 0.024921400, 0.020839810, 0.017235910, 0.014079240, 0.011345160, 0.009019658, 0.007097731, 0.005571145, 0.004394566, 0.003516303, 0.002887638, 0.002461588, 0.002206348, 0.002149559, 0.002337091, 0.002818931, 0.003649178, 0.004891359, 0.006629364, 0.008942902, 0.011902240, 0.015569890, 0.019976680, 0.025046980, 0.030675300, 0.036749990, 0.043151710, 0.049785840, 0.056685540, 0.063916510, 0.071543520, 0.079629170, 0.088214730, 0.097269780, 0.106750400, 0.116619200, 0.126846800, 0.137406000, 0.148247100, 0.159307600, 0.170518100, 0.181802600, 0.193109000, 0.204508500, 0.216116600, 0.228065000, 0.240501500, 0.253544100, 0.267130000, 0.281135100, 0.295416400, 0.309811700, 0.324167800, 0.338431900, 0.352578600, 0.366583900, 0.380424400, 0.394098800, 0.407697200, 0.421348400, 0.435200300, 0.449420600, 0.464161600, 0.479439500, 0.495218000, 0.511439500, 0.528023300, 0.544869600, 0.561889800, 0.579013700, 0.596188200, 0.613378400, 0.630589700, 0.647922300, 0.665486600, 0.683378200, 0.701677400, 0.720411000, 0.739449500, 0.758628500, 0.777788500, 0.796775000, 0.815453000, 0.833738900, 0.851549300, 0.868786200, 0.885337600, 0.901158800, 0.916527800, 0.931824500, 0.947452400, 0.963838800, 0.981259600, 0.999295300, 1.017343000, 1.034790000, 1.051011000, 1.065522000, 1.078421000, 1.089944000, 1.100320000, 1.109767000, 1.118438000, 1.126266000, 1.133138000, 1.138952000, 1.143620000, 1.147095000, 1.149464000, 1.150838000, 1.151326000, 1.151033000, 1.150002000, 1.148061000, 1.144998000, 1.140622000, 1.134757000, 1.127298000, 1.118342000, 1.108033000, 1.096515000, 1.083928000, 1.070387000, 1.055934000, 1.040592000, 1.024385000, 1.007344000, 0.989526800, 0.971121300, 0.952325700, 0.933324800, 0.914287700, 0.895279800, 0.876015700, 0.856160700, 0.835423500, 0.813556500, 0.790456500, 0.766436400, 0.741877700, 0.717121900, 0.692471700, 0.668160000, 0.644269700, 0.620845000, 0.597924300, 0.575541000, 0.553729600, 0.532541200, 0.512021800, 0.492207000, 0.473122400, 0.454741700, 0.436871900, 0.419312100, 0.401898000, 0.384498600, 0.367059200, 0.349716700, 0.332630500, 0.315934100, 0.299737400, 0.284118900, 0.269105300, 0.254707700, 0.240931900, 0.227779200, 0.215243100, 0.203301000, 0.191927600, 0.181098700, 0.170791400, 0.160984200, 0.151657700, 0.142793600, 0.134373700, 0.126380800, 0.118797900, 0.111608800, 0.104797500, 0.098348350, 0.092245970, 0.086475060, 0.081019860, 0.075865140, 0.070996330, 0.066399600, 0.062062250, 0.057974090, 0.054125330, 0.050506000, 0.047106060, 0.043914110, 0.040914110, 0.038090670, 0.035430340, 0.032921380, 0.030556720, 0.028341460, 0.026280330, 0.024374650, 0.022623060, 0.021019350, 0.019546470, 0.018187270, 0.016927270, 0.015754170, 0.014658540, 0.013635710, 0.012682050, 0.011793940, 0.010967780, 0.010199640, 0.009484317, 0.008816851, 0.008192921, 0.007608750, 0.007061391, 0.006549509, 0.006071970, 0.005627476, 0.005214608, 0.004831848, 0.004477579, 0.004150166, 0.003847988, 0.003569452, 0.003312857, 0.003076022, 0.002856894, 0.002653681, 0.002464821, 0.002289060, 0.002125694, 0.001974121, 0.001833723, 0.001703876, 0.001583904, 0.001472939, 0.001370151, 0.001274803, 0.001186238, 0.001103871, 0.001027194, 0.000955749, 0.000889126, 0.000826954, 0.000768935, 0.000714943, 0.000664859, 0.000618542, 0.000575830, 0.000536505, 0.000500184, 0.000466501, 0.000435139, 0.000405830, 0.000378373, 0.000352689, 0.000328720, 0.000306400, 0.000285658, 0.000266411, 0.000248546, 0.000231953, 0.000216530, 0.000202185, 0.000188834, 0.000176394, 0.000164790, 0.000153954, 0.000143827, 0.000134357, 0.000125514, 0.000117271, 0.000109598, 0.000102469, 0.000095847, 0.000089683, 0.000083927, 0.000078537, 0.000073476, 0.000068716, 0.000064253, 0.000060083, 0.000056201, 0.000052599, 0.000049263, 0.000046166, 0.000043282, 0.000040587, 0.000038061, 0.000035688, 0.000033460, 0.000031371, 0.000029414, 0.000027582, 0.000025870, 0.000024267, 0.000022766, 0.000021360, 0.000020041, 0.000018804, 0.000017644, 0.000016557, 0.000015539, 0.000014588, 0.000013699, 0.000012867, 0.000012089, 0.000011362, 0.000010681, 0.000010044, 0.000009446, 0.000008885, 0.000008356, 0.000007858, 0.000007387, 0.000006944, 0.000006527, 0.000006135, 0.000005768, 0.000005425, 0.000005104, 0.000004804, 0.000004522, 0.000004259, 0.000004013, 0.000003782, 0.000003564, 0.000003360, 0.000003168, 0.000002986, 0.000002815, 0.000002654, 0.000002502, 0.000002359, 0.000002224, 0.000002098, 0.000001979, 0.000001867, 0.000001762};
const double CMF_390_830_Y[] = {0.000414616, 0.000502833, 0.000608499, 0.000734444, 0.000883739, 0.001059646, 0.001265532, 0.001504753, 0.001780493, 0.002095572, 0.002452194, 0.002852216, 0.003299115, 0.003797466, 0.004352768, 0.004971717, 0.005661014, 0.006421615, 0.007250312, 0.008140173, 0.009079860, 0.010056080, 0.011064560, 0.012105220, 0.013180140, 0.014293770, 0.015450040, 0.016640930, 0.017853020, 0.019070180, 0.020273690, 0.021448050, 0.022600410, 0.023747890, 0.024912470, 0.026121060, 0.027399230, 0.028749930, 0.030169090, 0.031651450, 0.033190380, 0.034779120, 0.036414950, 0.038095690, 0.039818430, 0.041579400, 0.043370980, 0.045171800, 0.046954200, 0.048687180, 0.050336570, 0.051876110, 0.053322180, 0.054706030, 0.056063350, 0.057433930, 0.058851070, 0.060308090, 0.061786440, 0.063265700, 0.064723520, 0.066147490, 0.067572560, 0.069049280, 0.070632800, 0.072383390, 0.074359600, 0.076593830, 0.079114360, 0.081953450, 0.085148160, 0.088726570, 0.092660080, 0.096897230, 0.101374600, 0.106014500, 0.110737700, 0.115511100, 0.120312200, 0.125116100, 0.129895700, 0.134629900, 0.139330900, 0.144023500, 0.148737200, 0.153506600, 0.158364400, 0.163319900, 0.168376100, 0.173536500, 0.178804800, 0.184181900, 0.189655900, 0.195210100, 0.200825900, 0.206482800, 0.212182600, 0.218027900, 0.224158600, 0.230730200, 0.237916000, 0.245870600, 0.254602300, 0.264076000, 0.274249000, 0.285068000, 0.296483700, 0.308501000, 0.321139300, 0.334417500, 0.348353600, 0.362960100, 0.378227500, 0.394135900, 0.410658200, 0.427759500, 0.445399300, 0.463539600, 0.482137600, 0.501143000, 0.520497200, 0.540138700, 0.560020800, 0.580097200, 0.600317200, 0.620625600, 0.640939800, 0.661077200, 0.680813400, 0.699904400, 0.718089000, 0.735159300, 0.751182100, 0.766314300, 0.780735200, 0.794644800, 0.808207400, 0.821381700, 0.834070100, 0.846171100, 0.857579900, 0.868240800, 0.878306100, 0.887990700, 0.897521100, 0.907134700, 0.916994700, 0.926929500, 0.936673100, 0.945948200, 0.954467500, 0.961983400, 0.968439000, 0.973828900, 0.978151900, 0.981410600, 0.983666900, 0.985208100, 0.986381300, 0.987535700, 0.989022800, 0.991081100, 0.993491300, 0.995917200, 0.998020500, 0.999460800, 0.999993000, 0.999755700, 0.998983900, 0.997912300, 0.996773700, 0.995735600, 0.994711500, 0.993553400, 0.992115600, 0.990254900, 0.987859600, 0.984932400, 0.981503600, 0.977603500, 0.973261100, 0.968476400, 0.963136900, 0.957106200, 0.950254000, 0.942456900, 0.933689700, 0.924289300, 0.914670700, 0.905233300, 0.896361300, 0.888306900, 0.880846200, 0.873644500, 0.866375500, 0.858720300, 0.850429500, 0.841504700, 0.832010900, 0.822015400, 0.811586800, 0.800787400, 0.789651500, 0.778205300, 0.766473300, 0.754478500, 0.742247300, 0.729822900, 0.717252500, 0.704581800, 0.691855300, 0.679100900, 0.666284600, 0.653359500, 0.640280700, 0.627006600, 0.613514800, 0.599849400, 0.586068200, 0.572226100, 0.558374600, 0.544553500, 0.530767300, 0.517013000, 0.503288900, 0.489595000, 0.475944200, 0.462395800, 0.449015400, 0.435862200, 0.422989700, 0.410415200, 0.398035600, 0.385730000, 0.373390700, 0.360924500, 0.348286000, 0.335570200, 0.322896300, 0.310370400, 0.298086500, 0.286116000, 0.274482200, 0.263195300, 0.252262800, 0.241690200, 0.231480900, 0.221637800, 0.212162200, 0.203054200, 0.194312400, 0.185922700, 0.177827400, 0.169965400, 0.162284100, 0.154739700, 0.147308100, 0.140016900, 0.132901300, 0.125991300, 0.119312000, 0.112882000, 0.106711300, 0.100805200, 0.095166530, 0.089795940, 0.084690440, 0.079840090, 0.075233720, 0.070860610, 0.066710450, 0.062773600, 0.059041790, 0.055507030, 0.052161390, 0.048996990, 0.046005780, 0.043178850, 0.040507550, 0.037983760, 0.035599820, 0.033348560, 0.031223320, 0.029217800, 0.027326010, 0.025542230, 0.023861210, 0.022278590, 0.020790200, 0.019391850, 0.018079390, 0.016848170, 0.015691880, 0.014604460, 0.013580620, 0.012615730, 0.011706960, 0.010856080, 0.010064760, 0.009333376, 0.008661284, 0.008046048, 0.007481130, 0.006959987, 0.006477070, 0.006027677, 0.005608169, 0.005216691, 0.004851785, 0.004512008, 0.004195941, 0.003902057, 0.003628371, 0.003373005, 0.003134315, 0.002910864, 0.002701528, 0.002505796, 0.002323231, 0.002153333, 0.001995557, 0.001849316, 0.001713976, 0.001588899, 0.001473453, 0.001367022, 0.001268954, 0.001178421, 0.001094644, 0.001016943, 0.000944727, 0.000877517, 0.000815044, 0.000757076, 0.000703376, 0.000653705, 0.000607805, 0.000565344, 0.000526005, 0.000489506, 0.000455597, 0.000424055, 0.000394686, 0.000367318, 0.000341794, 0.000317974, 0.000295744, 0.000275056, 0.000255864, 0.000238114, 0.000221745, 0.000206671, 0.000192747, 0.000179832, 0.000167802, 0.000156557, 0.000146017, 0.000136154, 0.000126945, 0.000118367, 0.000110393, 0.000102991, 0.000096118, 0.000089733, 0.000083797, 0.000078274, 0.000073133, 0.000068341, 0.000063870, 0.000059694, 0.000055789, 0.000052135, 0.000048722, 0.000045538, 0.000042574, 0.000039819, 0.000037259, 0.000034875, 0.000032648, 0.000030561, 0.000028602, 0.000026758, 0.000025029, 0.000023414, 0.000021909, 0.000020513, 0.000019219, 0.000018018, 0.000016899, 0.000015853, 0.000014872, 0.000013951, 0.000013085, 0.000012273, 0.000011512, 0.000010800, 0.000010134, 0.000009510, 0.000008926, 0.000008378, 0.000007864, 0.000007382, 0.000006929, 0.000006505, 0.000006108, 0.000005737, 0.000005390, 0.000005065, 0.000004762, 0.000004478, 0.000004212, 0.000003962, 0.000003729, 0.000003509, 0.000003302, 0.000003107, 0.000002922, 0.000002748, 0.000002585, 0.000002431, 0.000002287, 0.000002152, 0.000002026, 0.000001907, 0.000001797, 0.000001693, 0.000001596, 0.000001505, 0.000001419, 0.000001339, 0.000001263, 0.000001191, 0.000001123, 0.000001059, 0.000000999, 0.000000942, 0.000000889, 0.000000839, 0.000000791, 0.000000747, 0.000000705};
const double CMF_390_830_Z[] = {0.018472600, 0.022211010, 0.026698190, 0.032069370, 0.038478320, 0.046097840, 0.055119530, 0.065752570, 0.078221130, 0.092760130, 0.109609000, 0.129007700, 0.151204700, 0.176444100, 0.204951700, 0.236924600, 0.272512300, 0.311782000, 0.354706400, 0.401147300, 0.450836900, 0.503416400, 0.558636100, 0.616273400, 0.676098200, 0.737882200, 0.801301900, 0.865557300, 0.929579100, 0.992129300, 1.051821000, 1.107509000, 1.159527000, 1.208869000, 1.256834000, 1.305008000, 1.354758000, 1.405594000, 1.456414000, 1.505960000, 1.552826000, 1.595902000, 1.635768000, 1.673573000, 1.710604000, 1.748280000, 1.787504000, 1.826609000, 1.863108000, 1.894332000, 1.917479000, 1.930529000, 1.934819000, 1.932650000, 1.926395000, 1.918437000, 1.910430000, 1.901224000, 1.889000000, 1.871996000, 1.848545000, 1.817792000, 1.781627000, 1.742514000, 1.702749000, 1.664439000, 1.629207000, 1.597360000, 1.568896000, 1.543823000, 1.522157000, 1.503611000, 1.486673000, 1.469595000, 1.450709000, 1.428440000, 1.401587000, 1.370094000, 1.334220000, 1.294275000, 1.250610000, 1.203696000, 1.154316000, 1.103284000, 1.051347000, 0.999178900, 0.947395800, 0.896622200, 0.847398100, 0.800157600, 0.755237900, 0.712787900, 0.672519800, 0.634097600, 0.597243300, 0.561731300, 0.527492100, 0.494880900, 0.464258600, 0.435884100, 0.409931300, 0.386426100, 0.365056600, 0.345481200, 0.327409500, 0.310593900, 0.294810200, 0.279819400, 0.265410000, 0.251408400, 0.237675300, 0.224121100, 0.210748400, 0.197583900, 0.184657400, 0.172001800, 0.159691800, 0.147941500, 0.136942800, 0.126827900, 0.117679600, 0.109497000, 0.102094300, 0.095279930, 0.088900750, 0.082835480, 0.077009820, 0.071440010, 0.066154360, 0.061171990, 0.056504070, 0.052151210, 0.048095660, 0.044317200, 0.040797340, 0.037519120, 0.034468460, 0.031637640, 0.029019010, 0.026603640, 0.024381640, 0.022340970, 0.020464150, 0.018734560, 0.017137880, 0.015661740, 0.014296440, 0.013037020, 0.011878970, 0.010817250, 0.009846470, 0.008960687, 0.008152811, 0.007416025, 0.006744115, 0.006131421, 0.005572778, 0.005063463, 0.004599169, 0.004175971, 0.003790291, 0.003438952, 0.003119341, 0.002829038, 0.002565722, 0.002327186, 0.002111280, 0.001915766, 0.001738589, 0.001577920, 0.001432128, 0.001299781, 0.001179667, 0.001070694, 0.000971862, 0.000882253, 0.000801023, 0.000727388, 0.000660635, 0.000600115, 0.000545242, 0.000495485, 0.000450364, 0.000409446, 0.000372335, 0.000338674, 0.000308140, 0.000280437, 0.000255300, 0.000232486, 0.000211777, 0.000192976, 0.000175902, 0.000160395, 0.000146306, 0.000133503, 0.000121866, 0.000111286, 0.000101663, 0.000092910, 0.000084945, 0.000077694, 0.000071092, 0.000065079, 0.000059601, 0.000054607, 0.000050054, 0.000045902, 0.000042113, 0.000038654, 0.000035497, 0.000032612, 0.000029976, 0.000027567, 0.000025363, 0.000023347, 0.000021502, 0.000019813, 0.000018265, 0.000016847, 0.000015546, 0.000014354, 0.000013259, 0.000012254, 0.000011332, 0.000010484, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000, 0.000000000};

// CIE XYZ 等色関数の配列。CIEの計算式に使用するため、5nm stepとしている。
// 2-degを使用するのが正解。JIS規格は誤記訂正されているものがあり注意が必要
//なお、等色関数の値は下記のサイトの値を使用した。
// http://cvrl.ioo.ucl.ac.uk/cmfs.htm
const double CMF2deg_360_830_X[]{0.0001299, 0.0002321, 0.0004149, 0.0007416, 0.001368, 0.002236, 0.004243, 0.00765, 0.01431, 0.02319, 0.04351, 0.07763, 0.13438, 0.21477, 0.2839, 0.3285, 0.34828, 0.34806, 0.3362, 0.3187, 0.2908, 0.2511, 0.19536, 0.1421, 0.09564, 0.05795001, 0.03201, 0.0147, 0.0049, 0.0024, 0.0093, 0.0291, 0.06327, 0.1096, 0.1655, 0.2257499, 0.2904, 0.3597, 0.4334499, 0.5120501, 0.5945, 0.6784, 0.7621, 0.8425, 0.9163, 0.9786, 1.0263, 1.0567, 1.0622, 1.0456, 1.0026, 0.9384, 0.8544499, 0.7514, 0.6424, 0.5419, 0.4479, 0.3608, 0.2835, 0.2187, 0.1649, 0.1212, 0.0874, 0.0636, 0.04677, 0.0329, 0.0227, 0.01584, 0.01135916, 0.008110916, 0.005790346, 0.004109457, 0.002899327, 0.00204919, 0.001439971, 0.000999949, 0.000690079, 0.000476021, 0.000332301, 0.000234826, 0.000166151, 0.000117413, 8.30753E-05, 5.87065E-05, 4.15099E-05, 2.93533E-05, 2.06738E-05, 1.45598E-05, 1.0254E-05, 7.22146E-06, 5.08587E-06, 3.58165E-06, 2.52253E-06, 1.77651E-06, 1.25114E-06};
const double CMF2deg_360_830_Y[]{0.000003917, 0.000006965, 0.00001239, 0.00002202, 0.000039, 0.000064, 0.00012, 0.000217, 0.000396, 0.00064, 0.00121, 0.00218, 0.004, 0.0073, 0.0116, 0.01684, 0.023, 0.0298, 0.038, 0.048, 0.06, 0.0739, 0.09098, 0.1126, 0.13902, 0.1693, 0.20802, 0.2586, 0.323, 0.4073, 0.503, 0.6082, 0.71, 0.7932, 0.862, 0.9148501, 0.954, 0.9803, 0.9949501, 1, 0.995, 0.9786, 0.952, 0.9154, 0.87, 0.8163, 0.757, 0.6949, 0.631, 0.5668, 0.503, 0.4412, 0.381, 0.321, 0.265, 0.217, 0.175, 0.1382, 0.107, 0.0816, 0.061, 0.04458, 0.032, 0.0232, 0.017, 0.01192, 0.00821, 0.005723, 0.004102, 0.002929, 0.002091, 0.001484, 0.001047, 0.00074, 0.00052, 0.0003611, 0.0002492, 0.0001719, 0.00012, 0.0000848, 0.00006, 0.0000424, 0.00003, 0.0000212, 0.00001499, 0.0000106, 7.4657E-06, 5.2578E-06, 3.7029E-06, 2.6078E-06, 1.8366E-06, 1.2934E-06, 9.1093E-07, 6.4153E-07, 4.5181E-07};
const double CMF2deg_360_830_Z[]{0.0006061, 0.001086, 0.001946, 0.003486, 0.006450001, 0.01054999, 0.02005001, 0.03621, 0.06785001, 0.1102, 0.2074, 0.3713, 0.6456, 1.0390501, 1.3856, 1.62296, 1.74706, 1.7826, 1.77211, 1.7441, 1.6692, 1.5281, 1.28764, 1.0419, 0.8129501, 0.6162, 0.46518, 0.3533, 0.272, 0.2123, 0.1582, 0.1117, 0.07824999, 0.05725001, 0.04216, 0.02984, 0.0203, 0.0134, 0.008749999, 0.005749999, 0.0039, 0.002749999, 0.0021, 0.0018, 0.001650001, 0.0014, 0.0011, 0.001, 0.0008, 0.0006, 0.00034, 0.00024, 0.00019, 0.0001, 5E-05, 0.00003, 0.00002, 0.00001, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};

//試験色の分光放射輝度率。1から14まではCIE,15はJISである。
// JIS Z 8726 1990で定義される15番は380to780nmなので、前後はダミー値0で埋めてある。
const double CIE_TCS14plus1_360_830[][95] =
    {
        {0.116, 0.136, 0.159, 0.19, 0.219, 0.239, 0.252, 0.256, 0.256, 0.254, 0.252, 0.248, 0.244, 0.24, 0.237, 0.232, 0.23, 0.226, 0.225, 0.222, 0.22, 0.218, 0.216, 0.214, 0.214, 0.214, 0.216, 0.218, 0.223, 0.225, 0.226, 0.226, 0.225, 0.225, 0.227, 0.23, 0.236, 0.245, 0.253, 0.262, 0.272, 0.283, 0.298, 0.318, 0.341, 0.367, 0.39, 0.409, 0.424, 0.435, 0.442, 0.448, 0.45, 0.451, 0.451, 0.451, 0.451, 0.451, 0.45, 0.45, 0.451, 0.451, 0.453, 0.454, 0.455, 0.457, 0.458, 0.46, 0.462, 0.463, 0.464, 0.465, 0.466, 0.466, 0.466, 0.466, 0.467, 0.467, 0.467, 0.467, 0.467, 0.467, 0.467, 0.467, 0.467, 0.467, 0.467, 0.466, 0.466, 0.466, 0.466, 0.466, 0.465, 0.464, 0.464},
        {0.053, 0.055, 0.059, 0.064, 0.07, 0.079, 0.089, 0.101, 0.111, 0.116, 0.118, 0.12, 0.121, 0.122, 0.122, 0.122, 0.123, 0.124, 0.127, 0.128, 0.131, 0.134, 0.138, 0.143, 0.15, 0.159, 0.174, 0.19, 0.207, 0.225, 0.242, 0.253, 0.26, 0.264, 0.267, 0.269, 0.272, 0.276, 0.282, 0.289, 0.299, 0.309, 0.322, 0.329, 0.335, 0.339, 0.341, 0.341, 0.342, 0.342, 0.342, 0.341, 0.341, 0.339, 0.339, 0.338, 0.338, 0.337, 0.336, 0.335, 0.334, 0.332, 0.332, 0.331, 0.331, 0.33, 0.329, 0.328, 0.328, 0.327, 0.326, 0.325, 0.324, 0.324, 0.324, 0.323, 0.322, 0.321, 0.32, 0.318, 0.316, 0.315, 0.315, 0.314, 0.314, 0.313, 0.313, 0.312, 0.312, 0.311, 0.311, 0.311, 0.311, 0.311, 0.31},
        {0.058, 0.059, 0.061, 0.063, 0.065, 0.068, 0.07, 0.072, 0.073, 0.073, 0.074, 0.074, 0.074, 0.073, 0.073, 0.073, 0.073, 0.073, 0.074, 0.075, 0.077, 0.08, 0.085, 0.094, 0.109, 0.126, 0.148, 0.172, 0.198, 0.221, 0.241, 0.26, 0.278, 0.302, 0.339, 0.37, 0.392, 0.399, 0.4, 0.393, 0.38, 0.365, 0.349, 0.332, 0.315, 0.299, 0.285, 0.272, 0.264, 0.257, 0.252, 0.247, 0.241, 0.235, 0.229, 0.224, 0.22, 0.217, 0.216, 0.216, 0.219, 0.224, 0.23, 0.238, 0.251, 0.269, 0.288, 0.312, 0.34, 0.366, 0.39, 0.412, 0.431, 0.447, 0.46, 0.472, 0.481, 0.488, 0.493, 0.497, 0.5, 0.502, 0.505, 0.51, 0.516, 0.52, 0.524, 0.527, 0.531, 0.535, 0.539, 0.544, 0.548, 0.552, 0.555},
        {0.057, 0.059, 0.062, 0.067, 0.074, 0.083, 0.093, 0.105, 0.116, 0.121, 0.124, 0.126, 0.128, 0.131, 0.135, 0.139, 0.144, 0.151, 0.161, 0.172, 0.186, 0.205, 0.229, 0.254, 0.281, 0.308, 0.332, 0.352, 0.37, 0.383, 0.39, 0.394, 0.395, 0.392, 0.385, 0.377, 0.367, 0.354, 0.341, 0.327, 0.312, 0.296, 0.28, 0.263, 0.247, 0.229, 0.214, 0.198, 0.185, 0.175, 0.169, 0.164, 0.16, 0.156, 0.154, 0.152, 0.151, 0.149, 0.148, 0.148, 0.148, 0.149, 0.151, 0.154, 0.158, 0.162, 0.165, 0.168, 0.17, 0.171, 0.17, 0.168, 0.166, 0.164, 0.164, 0.165, 0.168, 0.172, 0.177, 0.181, 0.185, 0.189, 0.192, 0.194, 0.197, 0.2, 0.204, 0.21, 0.218, 0.225, 0.233, 0.243, 0.254, 0.264, 0.274},
        {0.143, 0.187, 0.233, 0.269, 0.295, 0.306, 0.31, 0.312, 0.313, 0.315, 0.319, 0.322, 0.326, 0.33, 0.334, 0.339, 0.346, 0.352, 0.36, 0.369, 0.381, 0.394, 0.403, 0.41, 0.415, 0.418, 0.419, 0.417, 0.413, 0.409, 0.403, 0.396, 0.389, 0.381, 0.372, 0.363, 0.353, 0.342, 0.331, 0.32, 0.308, 0.296, 0.284, 0.271, 0.26, 0.247, 0.232, 0.22, 0.21, 0.2, 0.194, 0.189, 0.185, 0.183, 0.18, 0.177, 0.176, 0.175, 0.175, 0.175, 0.175, 0.177, 0.18, 0.183, 0.186, 0.189, 0.192, 0.195, 0.199, 0.2, 0.199, 0.198, 0.196, 0.195, 0.195, 0.196, 0.197, 0.2, 0.203, 0.205, 0.208, 0.212, 0.215, 0.217, 0.219, 0.222, 0.226, 0.231, 0.237, 0.243, 0.249, 0.257, 0.265, 0.273, 0.28},
        {0.079, 0.081, 0.089, 0.113, 0.151, 0.203, 0.265, 0.339, 0.41, 0.464, 0.492, 0.508, 0.517, 0.524, 0.531, 0.538, 0.544, 0.551, 0.556, 0.556, 0.554, 0.549, 0.541, 0.531, 0.519, 0.504, 0.488, 0.469, 0.45, 0.431, 0.414, 0.395, 0.377, 0.358, 0.341, 0.325, 0.309, 0.293, 0.279, 0.265, 0.253, 0.241, 0.234, 0.227, 0.225, 0.222, 0.221, 0.22, 0.22, 0.22, 0.22, 0.22, 0.223, 0.227, 0.233, 0.239, 0.244, 0.251, 0.258, 0.263, 0.268, 0.273, 0.278, 0.281, 0.283, 0.286, 0.291, 0.296, 0.302, 0.313, 0.325, 0.338, 0.351, 0.364, 0.376, 0.389, 0.401, 0.413, 0.425, 0.436, 0.447, 0.458, 0.469, 0.477, 0.485, 0.493, 0.5, 0.506, 0.512, 0.517, 0.521, 0.525, 0.529, 0.532, 0.535},
        {0.15, 0.177, 0.218, 0.293, 0.378, 0.459, 0.524, 0.546, 0.551, 0.555, 0.559, 0.56, 0.561, 0.558, 0.556, 0.551, 0.544, 0.535, 0.522, 0.506, 0.488, 0.469, 0.448, 0.429, 0.408, 0.385, 0.363, 0.341, 0.324, 0.311, 0.301, 0.291, 0.283, 0.273, 0.265, 0.26, 0.257, 0.257, 0.259, 0.26, 0.26, 0.258, 0.256, 0.254, 0.254, 0.259, 0.27, 0.284, 0.302, 0.324, 0.344, 0.362, 0.377, 0.389, 0.4, 0.41, 0.42, 0.429, 0.438, 0.445, 0.452, 0.457, 0.462, 0.466, 0.468, 0.47, 0.473, 0.477, 0.483, 0.489, 0.496, 0.503, 0.511, 0.518, 0.525, 0.532, 0.539, 0.546, 0.553, 0.559, 0.565, 0.57, 0.575, 0.578, 0.581, 0.583, 0.585, 0.587, 0.588, 0.589, 0.59, 0.59, 0.59, 0.591, 0.592},
        {0.075, 0.078, 0.084, 0.09, 0.104, 0.129, 0.17, 0.24, 0.319, 0.416, 0.462, 0.482, 0.49, 0.488, 0.482, 0.473, 0.462, 0.45, 0.439, 0.426, 0.413, 0.397, 0.382, 0.366, 0.352, 0.337, 0.325, 0.31, 0.299, 0.289, 0.283, 0.276, 0.27, 0.262, 0.256, 0.251, 0.25, 0.251, 0.254, 0.258, 0.264, 0.269, 0.272, 0.274, 0.278, 0.284, 0.295, 0.316, 0.348, 0.384, 0.434, 0.482, 0.528, 0.568, 0.604, 0.629, 0.648, 0.663, 0.676, 0.685, 0.693, 0.7, 0.705, 0.709, 0.712, 0.715, 0.717, 0.719, 0.721, 0.72, 0.719, 0.722, 0.725, 0.727, 0.729, 0.73, 0.73, 0.73, 0.73, 0.73, 0.73, 0.73, 0.73, 0.73, 0.73, 0.73, 0.731, 0.731, 0.731, 0.731, 0.731, 0.731, 0.731, 0.731, 0.731},
        {0.069, 0.072, 0.073, 0.07, 0.066, 0.062, 0.058, 0.055, 0.052, 0.052, 0.051, 0.05, 0.05, 0.049, 0.048, 0.047, 0.046, 0.044, 0.042, 0.041, 0.038, 0.035, 0.033, 0.031, 0.03, 0.029, 0.028, 0.028, 0.028, 0.029, 0.03, 0.03, 0.031, 0.031, 0.032, 0.032, 0.033, 0.034, 0.035, 0.037, 0.041, 0.044, 0.048, 0.052, 0.06, 0.076, 0.102, 0.136, 0.19, 0.256, 0.336, 0.418, 0.505, 0.581, 0.641, 0.682, 0.717, 0.74, 0.758, 0.77, 0.781, 0.79, 0.797, 0.803, 0.809, 0.814, 0.819, 0.824, 0.828, 0.83, 0.831, 0.833, 0.835, 0.836, 0.836, 0.837, 0.838, 0.839, 0.839, 0.839, 0.839, 0.839, 0.839, 0.839, 0.839, 0.839, 0.839, 0.839, 0.839, 0.839, 0.838, 0.837, 0.837, 0.836, 0.836},
        {0.042, 0.043, 0.045, 0.047, 0.05, 0.054, 0.059, 0.063, 0.066, 0.067, 0.068, 0.069, 0.069, 0.07, 0.072, 0.073, 0.076, 0.078, 0.083, 0.088, 0.095, 0.103, 0.113, 0.125, 0.142, 0.162, 0.189, 0.219, 0.262, 0.305, 0.365, 0.416, 0.465, 0.509, 0.546, 0.581, 0.61, 0.634, 0.653, 0.666, 0.678, 0.687, 0.693, 0.698, 0.701, 0.704, 0.705, 0.705, 0.706, 0.707, 0.707, 0.707, 0.708, 0.708, 0.71, 0.711, 0.712, 0.714, 0.716, 0.718, 0.72, 0.722, 0.725, 0.729, 0.731, 0.735, 0.739, 0.742, 0.746, 0.748, 0.749, 0.751, 0.753, 0.754, 0.755, 0.755, 0.755, 0.755, 0.756, 0.757, 0.758, 0.759, 0.759, 0.759, 0.759, 0.759, 0.759, 0.759, 0.759, 0.759, 0.758, 0.757, 0.757, 0.756, 0.756},
        {0.074, 0.079, 0.086, 0.098, 0.111, 0.121, 0.127, 0.129, 0.127, 0.121, 0.116, 0.112, 0.108, 0.105, 0.104, 0.104, 0.105, 0.106, 0.11, 0.115, 0.123, 0.134, 0.148, 0.167, 0.192, 0.219, 0.252, 0.291, 0.325, 0.347, 0.356, 0.353, 0.346, 0.333, 0.314, 0.294, 0.271, 0.248, 0.227, 0.206, 0.188, 0.17, 0.153, 0.138, 0.125, 0.114, 0.106, 0.1, 0.096, 0.092, 0.09, 0.087, 0.085, 0.082, 0.08, 0.079, 0.078, 0.078, 0.078, 0.078, 0.081, 0.083, 0.088, 0.093, 0.102, 0.112, 0.125, 0.141, 0.161, 0.182, 0.203, 0.223, 0.242, 0.257, 0.27, 0.282, 0.292, 0.302, 0.31, 0.314, 0.317, 0.323, 0.33, 0.334, 0.338, 0.343, 0.348, 0.353, 0.359, 0.365, 0.372, 0.38, 0.388, 0.396, 0.403},
        {0.189, 0.175, 0.158, 0.139, 0.12, 0.103, 0.09, 0.082, 0.076, 0.068, 0.064, 0.065, 0.075, 0.093, 0.123, 0.16, 0.207, 0.256, 0.3, 0.331, 0.346, 0.347, 0.341, 0.328, 0.307, 0.282, 0.257, 0.23, 0.204, 0.178, 0.154, 0.129, 0.109, 0.09, 0.075, 0.062, 0.051, 0.041, 0.035, 0.029, 0.025, 0.022, 0.019, 0.017, 0.017, 0.017, 0.016, 0.016, 0.016, 0.016, 0.016, 0.016, 0.016, 0.016, 0.018, 0.018, 0.018, 0.018, 0.019, 0.02, 0.023, 0.024, 0.026, 0.03, 0.035, 0.043, 0.056, 0.074, 0.097, 0.128, 0.166, 0.21, 0.257, 0.305, 0.354, 0.401, 0.446, 0.485, 0.52, 0.551, 0.577, 0.599, 0.618, 0.633, 0.645, 0.656, 0.666, 0.674, 0.68, 0.686, 0.691, 0.694, 0.697, 0.7, 0.702},
        {0.071, 0.076, 0.082, 0.09, 0.104, 0.127, 0.161, 0.211, 0.264, 0.313, 0.341, 0.352, 0.359, 0.361, 0.364, 0.365, 0.367, 0.369, 0.372, 0.374, 0.376, 0.379, 0.384, 0.389, 0.397, 0.405, 0.416, 0.429, 0.443, 0.454, 0.461, 0.466, 0.469, 0.471, 0.474, 0.476, 0.483, 0.49, 0.506, 0.526, 0.553, 0.582, 0.618, 0.651, 0.68, 0.701, 0.717, 0.729, 0.736, 0.742, 0.745, 0.747, 0.748, 0.748, 0.748, 0.748, 0.748, 0.748, 0.748, 0.748, 0.747, 0.747, 0.747, 0.747, 0.747, 0.747, 0.747, 0.746, 0.746, 0.746, 0.745, 0.744, 0.743, 0.744, 0.745, 0.748, 0.75, 0.75, 0.749, 0.748, 0.748, 0.747, 0.747, 0.747, 0.747, 0.746, 0.746, 0.746, 0.746, 0.745, 0.745, 0.745, 0.745, 0.745, 0.745},
        {0.036, 0.036, 0.036, 0.036, 0.036, 0.036, 0.037, 0.038, 0.039, 0.039, 0.04, 0.041, 0.042, 0.042, 0.043, 0.044, 0.044, 0.045, 0.045, 0.046, 0.047, 0.048, 0.05, 0.052, 0.055, 0.057, 0.062, 0.067, 0.075, 0.083, 0.092, 0.1, 0.108, 0.121, 0.133, 0.142, 0.15, 0.154, 0.155, 0.152, 0.147, 0.14, 0.133, 0.125, 0.118, 0.112, 0.106, 0.101, 0.098, 0.095, 0.093, 0.09, 0.089, 0.087, 0.086, 0.085, 0.084, 0.084, 0.084, 0.084, 0.085, 0.087, 0.092, 0.096, 0.102, 0.11, 0.123, 0.137, 0.152, 0.169, 0.188, 0.207, 0.226, 0.243, 0.26, 0.277, 0.294, 0.31, 0.325, 0.339, 0.353, 0.366, 0.379, 0.39, 0.399, 0.408, 0.416, 0.422, 0.428, 0.434, 0.439, 0.444, 0.448, 0.451, 0.454},
        {0, 0, 0, 0, 0.131, 0.139, 0.147, 0.153, 0.158, 0.162, 0.164, 0.167, 0.17, 0.175, 0.182, 0.192, 0.203, 0.212, 0.221, 0.229, 0.236, 0.243, 0.249, 0.254, 0.259, 0.264, 0.269, 0.276, 0.284, 0.291, 0.296, 0.298, 0.296, 0.289, 0.282, 0.276, 0.274, 0.276, 0.281, 0.286, 0.291, 0.289, 0.286, 0.28, 0.285, 0.314, 0.354, 0.398, 0.44, 0.47, 0.494, 0.511, 0.524, 0.535, 0.544, 0.552, 0.559, 0.565, 0.571, 0.576, 0.581, 0.586, 0.59, 0.594, 0.599, 0.603, 0.606, 0.61, 0.612, 0.614, 0.616, 0.616, 0.616, 0.616, 0.615, 0.613, 0.612, 0.61, 0.609, 0.608, 0.607, 0.607, 0.609, 0.61, 0.611, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};

//試験色の16bitカラー値。Riのカラー棒グラフに使用する
const uint16_t ricolor[]{0xBC50, 0xA4AC, 0x8506, 0x5D2E, 0x64F4, 0x74B9, 0xA458, 0xBC15, 0xB927, 0xEE46, 0x046C, 0x0272, 0xEE14, 0x5B27, 0xBC4F, 0xFFFF};

// CIE Publication No.15(E1.3.1.)1971 spectral power distribution (SPD)
const double SPD_S1[] ={61.5,65.15,68.8,66.1,63.4,64.6,65.8,80.3,94.8,99.8,104.8,105.35,105.9,101.35,96.8,105.35,113.9,119.75,125.6,125.55,125.5,123.4,121.3,121.3,121.3,117.4,113.5,113.3,113.1,111.95,110.8,108.65,106.5,107.65,108.8,107.05,105.3,104.85,104.4,102.2,100,98,96,95.55,95.1,92.1,89.1,89.8,90.5,90.4,90.3,89.35,88.4,86.2,84,84.55,85.1,83.5,81.9,82.25,82.6,83.75,84.9,83.1,81.3,76.6,71.9,73.1,74.3,75.35,76.4,69.85,63.3,67.5,71.7,74.35,77,71.1,65.2,56.45,47.7,58.15,68.6,66.8,65,65.5,66,63.5,61,57.15,53.3,56.1,58.9,60.4,61.9};
const double SPD_S2[] = {38, 40.2, 42.4, 40.45, 38.5, 36.75, 35, 39.2, 43.4, 44.85, 46.3, 45.1, 43.9, 40.5, 37.1, 36.9, 36.7, 36.3, 35.9, 34.25, 32.6, 30.25, 27.9, 26.1, 24.3, 22.2, 20.1, 18.15, 16.2, 14.7, 13.2, 10.9, 8.6, 7.35, 6.1, 5.15, 4.2, 3.05, 1.9, 0.95, 0, -0.8, -1.6, -2.55, -3.5, -3.5, -3.5, -4.65, -5.8, -6.5, -7.2, -7.9, -8.6, -9.05, -9.5, -10.2, -10.9, -10.8, -10.7, -11.35, -12, -13, -14, -13.8, -13.6, -12.8, -12, -12.65, -13.3, -13.1, -12.9, -11.75, -10.6, -11.1, -11.6, -11.9, -12.2, -11.2, -10.2, -9, -7.8, -9.5, -11.2, -10.8, -10.4, -10.5, -10.6, -10.15, -9.7, -9, -8.3, -8.8, -9.3, -9.55, -9.8};
const double SPD_S3[] = {5.3, 5.7, 6.1, 4.55, 3, 2.1, 1.2, 0.05, -1.1, -0.8, -0.5, -0.6, -0.7, -0.95, -1.2, -1.9, -2.6, -2.75, -2.9, -2.85, -2.8, -2.7, -2.6, -2.6, -2.6, -2.2, -1.8, -1.65, -1.5, -1.4, -1.3, -1.25, -1.2, -1.1, -1, -0.75, -0.5, -0.4, -0.3, -0.15, 0, 0.1, 0.2, 0.35, 0.5, 1.3, 2.1, 2.65, 3.2, 3.65, 4.1, 4.4, 4.7, 4.9, 5.1, 5.9, 6.7, 7, 7.3, 7.95, 8.6, 9.2, 9.8, 10, 10.2, 9.25, 8.3, 8.95, 9.6, 9.05, 8.5, 7.75, 7, 7.3, 7.6, 7.8, 8, 7.35, 6.7, 5.95, 5.2, 6.3, 7.4, 7.1, 6.8, 6.9, 7, 6.7, 6.4, 5.95, 5.5, 5.8, 6.1, 6.3, 6.5};

//ハロゲンランプを使って求めたキャリブレーション値。感度を補正するための配列
const double Relative_Sensitivity_288[] = {764.4946354, 683.3724191, 604.9915809, 544.0103871, 495.6078834, 445.8516572, 403.6584577, 364.8263251, 329.4126507, 297.1018747, 268.6228387, 242.2332302, 218.9366825, 199.2438179, 179.4168551, 165.6956859, 147.9265482, 137.1959972, 127.8250094, 117.6546807, 109.0834039, 101.3854325, 94.64737842, 89.99966367, 86.06359449, 81.9325168, 78.67361103, 74.35564465, 72.63896052, 70.20828011, 68.33613951, 68.10182794, 67.034331, 68.31167712, 69.81508953, 70.1201898, 73.42688883, 74.98639428, 78.46803673, 82.43203269, 84.77096906, 87.04942893, 87.87710862, 87.80202709, 86.07991123, 84.83221875, 83.43281479, 82.95788557, 83.40301693, 83.43836654, 84.49691505, 85.05029001, 85.84419183, 87.73945893, 89.19456854, 90.26087898, 90.78740726, 92.2190497, 93.08880852, 94.20969954, 95.17671809, 95.55509738, 94.44328447, 94.69350412, 94.48164679, 93.4950047, 93.15307887, 91.83980972, 90.50232028, 89.49152682, 88.13789653, 86.87275085, 84.40782593, 83.59968196, 83.08538841, 81.80168042, 80.32905862, 79.65979774, 79.52803784, 78.29888799, 78.58461316, 78.65766802, 79.14265574, 79.1341351, 79.55394656, 80.00953306, 80.34916854, 81.3490604, 80.79632996, 80.71299763, 80.66113071, 80.24030536, 78.82476411, 79.08638065, 78.40282836, 78.10359646, 77.44311547, 76.92339811, 76.71493494, 76.93880887, 76.92942982, 76.07323283, 76.29283759, 76.41011709, 76.4946812, 75.86455498, 76.27155341, 76.04557733, 76.09421224, 76.74768754, 76.36726273, 76.45725493, 76.5962381, 76.33644647, 76.13247434, 75.78659806, 75.53509788, 75.17312481, 75.02211971, 75.85406921, 75.6535159, 75.77956413, 75.50918548, 75.39911129, 74.70676867, 73.92360689, 73.55191962, 72.8149591, 72.43645007, 72.27796031, 72.2676536, 71.4640123, 71.77244504, 71.81682662, 71.40343456, 70.77133757, 70.7800337, 70.27115578, 69.93237982, 69.17727254, 68.36469986, 67.11880553, 67.00081782, 66.21978026, 66.01487102, 65.21150726, 64.53900819, 64.40828056, 63.69798437, 63.43615496, 62.07687213, 61.56288647, 61.11652771, 60.45028242, 60.14719447, 59.55211733, 59.62524609, 58.69271445, 58.22287128, 58.06274875, 57.45691546, 56.88333027, 56.15614462, 55.76785348, 55.3748308, 55.12201723, 54.71997922, 54.13328692, 53.40731709, 52.92435692, 52.71444533, 52.60736535, 51.8535829, 51.31355976, 50.860293, 50.6642333, 50.20748919, 49.50430106, 49.00451089, 48.56998129, 47.74919143, 47.35125436, 47.29593803, 47.09213179, 46.81919871, 46.11205972, 45.96306834, 45.69876272, 45.62996639, 45.48104446, 45.19890848, 44.56260483, 43.68303588, 43.43104358, 43.35802931, 42.56884842, 42.53972897, 41.74912882, 41.49021194, 40.95142297, 40.90029059, 40.34719278, 40.28136276, 39.94924958, 39.19189206, 38.79985134, 38.22615666, 37.87109561, 37.43520958, 36.51674237, 36.33520264, 35.52874015, 35.13132175, 34.86251972, 34.31219034, 33.8805446, 33.73846707, 33.1740938, 32.84525182, 32.65568887, 32.36287279, 32.01708025, 31.70796824, 31.0639494, 30.52935173, 30.24597887, 29.83994518, 29.51715527, 29.05545649, 28.4947296, 28.06289806, 27.57324254, 27.34603974, 27.09662976, 26.79580388, 26.48356476, 26.27651733, 26.07260772, 25.69843361, 25.42191723, 25.02640741, 24.81759203, 24.46431859, 23.91458622, 23.69349765, 23.22705246, 22.83197146, 22.63637753, 22.18113851, 21.73574451, 21.46485357, 21.32505551, 21.04246587, 20.78354669, 20.62969899, 20.52571095, 20.00517798, 19.84472121, 19.69541136, 19.42363335, 19.24066555, 18.98761882, 18.77682247, 18.70614575, 18.39560705, 18.12543634, 17.94464773, 17.82573561, 17.55796061, 17.3146041, 16.97916259, 16.95730285, 16.52207383, 16.39339918, 16.0548239, 15.8392757, 15.86648034, 15.58535148, 15.41664202, 15.1921949, 15.17981098, 14.86995408, 14.86034745, 14.59320879, 14.45486564, 14.21787897, 14.01214627, 13.91076723};

//データシートのグラフから求められた補正値は使用しないが、参考のためここに残しました。
//分光感度特性のグラフをもとに、感度を補正するための配列。正確なキャリブレーションができないため、データシートのグラフをもとにそれっぽい値を作成した。
// const double Relative_Sensitivity_340_850[] = {54.20285846, 54.8794054, 55.55595234, 56.11997971, 56.6828394, 57.24569908, 57.9587263, 58.67675984, 59.36860667, 60.0278457, 60.68708472, 61.51481672, 62.35629423, 63.06500818, 63.74117465, 64.4317734, 65.28799481, 66.14421622, 66.88806684, 67.59570818, 68.20565527, 68.70311719, 69.2005791, 70.43844858, 71.2672269, 72.42016805, 73.06132086, 73.67816913, 74.25860598, 75.3968254, 76.22267357, 76.91713751, 77.74069852, 78.80837649, 78.80073366, 80.52276563, 81.07918145, 81.51200078, 82.05076237, 83.01343424, 83.96325607, 84.62085076, 85.27844544, 85.93546979, 86.59100157, 87.24653334, 88.11767821, 89.13419045, 88.6455331, 89.22342316, 89.87113606, 90.51884895, 91.16656184, 91.7659287, 92.20149631, 92.63706393, 93.07263154, 93.49818431, 93.91454508, 94.33090584, 94.7472683, 95.1636458, 95.578994, 95.75621114, 95.93342829, 96.11064544, 96.28786259, 96.4314641, 96.53781281, 96.64416152, 96.75051023, 96.76591554, 96.76254725, 96.75917896, 96.75581067, 96.75244238, 96.69839323, 96.61788094, 96.53736865, 96.45685636, 96.34660495, 96.22024763, 96.09389031, 95.967533, 95.84117568, 95.73020428, 95.62188766, 95.51357104, 95.40525442, 95.2969378, 95.14875962, 94.95317161, 94.75758361, 94.56484598, 94.42406394, 94.2832819, 94.14249985, 94.01230632, 93.9039999, 93.79569348, 93.68738706, 93.57908065, 93.47949809, 93.40617444, 93.3328508, 93.25952715, 93.19796119, 93.20247813, 93.20699507, 93.21151201, 93.21602895, 93.24981953, 93.32107537, 93.39233122, 93.46358707, 93.53484291, 93.70466655, 93.87818133, 94.05169612, 94.22561681, 94.42547788, 94.62533895, 94.82520002, 95.0250611, 95.25714267, 95.49804792, 95.73895317, 95.95029875, 96.15370548, 96.35711221, 96.59745087, 96.85779087, 97.11813088, 97.36989372, 97.60661535, 97.84333698, 98.04247351, 98.20558843, 98.36870336, 98.53181828, 98.6949332, 98.83478368, 98.96631409, 99.0978445, 99.22937491, 99.35076018, 99.44988459, 99.54900901, 99.64813342, 99.74725784, 99.7395355, 99.72157966, 99.70362382, 99.68566798, 99.66771214, 99.64975629, 99.63180045, 99.61384461, 99.59588877, 99.51206892, 99.37348578, 99.23490265, 99.09631951, 98.95773638, 98.81915325, 98.49380968, 98.15452005, 97.81523042, 97.47731491, 97.15093455, 96.82455419, 96.26657195, 95.73097678, 95.43440653, 95.13783629, 94.52330019, 93.91268925, 93.39286313, 92.87303701, 92.43030701, 92.02349707, 91.55974548, 90.88485482, 90.32136753, 89.8188034, 89.36806147, 88.94961569, 88.3023941, 87.54423291, 86.95740655, 86.3705802, 85.85993996, 85.37749074, 84.89504151, 84.46292576, 84.15551662, 83.84810748, 82.77998776, 82.21273517, 81.69410364, 81.44505154, 81.19599943, 80.94694733, 80.58340462, 79.99657826, 79.52705581, 79.31827865, 79.10950148, 78.90072432, 78.64779087, 78.25296065, 77.96522828, 77.81430073, 77.66337318, 77.51244563, 77.36932611, 77.2790361, 77.18874609, 77.09845608, 77.00816606, 76.96112599, 76.93880887, 76.91649174, 76.89417462, 76.87185749, 76.91019102, 76.95169664, 76.99320225, 77.03470786, 77.09713709, 77.16409707, 77.23105704, 77.29801702, 77.364977, 77.45123155, 77.54353183, 77.6358321, 77.72810876, 77.80366597, 77.87922318, 77.9547804, 78.03033761, 78.10524945, 78.17971505, 78.25418066, 78.32864626, 78.39651717, 78.43456068, 78.47260419, 78.51064769, 78.5486912, 78.55390613, 78.510354, 78.46680186, 78.42324973, 78.36589443, 78.284773, 78.20365157, 78.12253013, 78.02482203, 77.87579847, 77.72677492, 77.57775136, 77.42872781, 77.25026831, 77.04908472, 76.8707483, 76.8707483, 76.85093319, 76.57855121, 76.30616923, 76.03378725, 75.7990132, 75.59298782, 75.38696244, 75.18093706, 74.94743592, 74.71240453, 74.47737315, 74.26211279, 74.05270899, 73.84330519, 73.5855104, 73.31840749, 73.05130458, 72.8098509, 72.57576637, 72.34168184, 72.08166159, 71.81213838, 71.52373792, 71.19440513, 70.86507233, 70.57556694, 70.30794134, 70.04031575, 69.82734979, 69.65225058, 69.47715137, 69.30205216, 69.04969228, 68.72549498, 68.40129769, 67.95326555, 67.58636364, 67.36363636, 67.14090908, 66.87890658, 66.5574705, 66.2363213, 65.95359056, 65.67085981, 65.37451304, 65.04806656, 64.72162008, 64.28959147, 63.88736208, 63.65018396, 63.41300584, 63.17373662, 62.84625705, 62.51877749, 62.19129793, 61.86381837, 61.52799928, 61.16453503, 60.80107078, 60.43760652, 60.07414227, 59.71067802, 59.32692694, 58.94239935, 58.55787177, 58.17334418, 57.79132622, 57.41063966, 57.0299531, 56.64926655, 56.28729496, 55.93307809, 55.57886123, 55.22464436, 54.86950247, 54.48660199, 54.1037015, 53.72080101, 53.33790053, 52.98495519, 52.63601601, 52.28707683, 51.93813766, 51.59370692, 51.26270416, 50.9317014, 50.60069863, 50.26969587, 49.93869311, 49.56983492, 49.17921418, 48.78859345, 48.39797271, 48.00735197, 47.69933114, 47.40330071, 47.10727029, 46.81123987, 46.51520944, 46.19762655, 45.72452022, 45.25141389, 44.77830756, 44.48580002, 44.20643447, 43.92706892, 43.64770338, 43.36833783, 43.02527701, 42.55827341, 42.09126981, 41.65607259, 41.35300554, 41.04993849, 40.74687143, 40.44380438, 40.14073733, 39.81606024, 39.48737533, 39.15869042, 38.83000551, 38.51229161, 38.20897477, 37.90565793, 37.60234109, 37.29902425, 36.984234, 36.6660748, 36.3479156, 36.0297564, 35.71159719, 35.39572391, 35.07989453, 34.76406515, 34.44823576, 34.13416925, 33.82765801, 33.52114678, 33.21463555, 32.90812432, 32.60346136, 32.30160854, 31.99975572, 31.6979029, 31.39605008, 31.10492579, 30.82083233, 30.53673886, 30.2526454, 29.96855194, 29.68837107, 29.41379438, 29.13921769, 28.864641, 28.59006432, 28.31548763, 28.0549006, 27.79742318, 27.53994575, 27.28246833, 27.02499091, 26.77092415, 26.52866006, 26.28639598, 26.0441319, 25.80186781, 25.55960373, 25.32112681, 25.09534742, 24.86956803, 24.64378864, 24.41800926, 24.19222987, 23.96645048, 23.73739583, 23.50769201, 23.27798819, 23.04828438, 22.81858056, 22.58887674, 22.35687203, 22.12193516, 21.8869983, 21.65206143, 21.41712456, 21.18218769, 20.94709062, 20.70860374, 20.47011685, 20.23162997, 19.99314308, 19.7546562, 19.51616932, 19.29432407, 19.07977493, 18.86522579, 18.65067665, 18.43612751, 18.22157837, 18.00613001, 17.78805322, 17.56997642, 17.35189962, 17.13382283, 16.91574603, 16.69766923, 16.48552744, 16.28036633, 16.07520522, 15.8700441, 15.66488299, 15.45972188, 15.25456077, 15.05310084, 14.86198813, 14.67087542, 14.47976271, 14.28864999, 14.09753728, 13.90642457, 13.71531185, 13.5365882, 13.36406278, 13.19153737, 13.01901196, 12.84648655, 12.67396114, 12.50143572, 12.32891031, 12.16029131, 12.00232359, 11.84435587, 11.68638816, 11.52842044, 11.37045272, 11.212485, 11.05451728, 10.89654956, 10.7573908, 10.63953361, 10.52167642, 10.40381924, 10.28596205};

